"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[354],{1120:function(t,e,a){a.d(e,{A:function(){return D}});var o=a(641),n=a(33),s=a.p+"img/book.a7af3d3b.png";const c={class:"leotaro relative w-full h-[47.5rem] text-center flex justify-end items-center mb-[3.75rem]"},l={key:0,class:"w-1/2 pr-[3rem] pl-[1.5rem] z-10"},r={class:"text-black text-wrap text-[1.66625rem] font-['Leotaro']"},i={class:"text-[0.99975rem] font-['Leotaro']"},p={key:1,class:"w-full h-full px-[1.5rem] z-10 flex"},h={class:"w-1/2 h-full flex flex-col justify-start p-[3.8rem]"},u={class:"flex justify-between items-end"},g={class:"text-[0.99975rem] helvetica text-black"},d={class:"text-[0.99975rem] helvetica"},f={key:2,class:"w-full h-full px-[1.5rem] z-10 flex"},x={class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},m={class:"header h-[10%]"},k={class:"text-black text-wrap text-[1.66625rem] font-['Leotaro'] text-left"},b={class:"body h-[85%]"},v={key:0,class:"font-[Montserrat] text-black text-[1.66625rem] text-center mb-[.4rem] font-bold"},y=["src"],w=["innerHTML"],$={class:"footer h-[5%]"},E={class:"helvetica text-[1.4163125rem] text-black"},L={class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},C={class:"header h-[10%]"},R={class:"text-black text-wrap text-[1.66625rem] font-['Leotaro'] text-right"},_={class:"body h-[85%]"},j={key:0,class:"font-[Montserrat] text-black text-[1.66625rem] text-center mb-[.4rem] font-bold"},X=["src"],A=["innerHTML"],I={class:"footer h-[5%]"},B={class:"helvetica text-[1.4163125rem] text-black"};function F(t,e,a,F,T,M){return(0,o.uX)(),(0,o.CE)("div",c,[a.payload.title?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("h1",r,(0,n.v_)(a.payload.title),1),(0,o.Lk)("h2",i,(0,n.v_)(a.payload.subtitle),1)])):a.payload.review?((0,o.uX)(),(0,o.CE)("div",p,[e[2]||(e[2]=(0,o.Lk)("div",{class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},null,-1)),(0,o.Lk)("div",h,[e[1]||(e[1]=(0,o.Lk)("h1",{class:"text-black text-wrap text-[1.66625rem] font-['Leotaro']"},"Содержание",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.payload.chapters,(t=>((0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("h2",g,(0,n.v_)(t.title),1),e[0]||(e[0]=(0,o.Lk)("span",{class:"bb"},null,-1)),(0,o.Lk)("h2",d,(0,n.v_)((t.last_page??0)+1),1)])))),256))])])):((0,o.uX)(),(0,o.CE)("div",f,[(0,o.Lk)("div",x,[(0,o.Lk)("div",m,[(0,o.Lk)("p",k,(0,n.v_)(M.book.title),1)]),(0,o.Lk)("div",b,[a.payload[0]?.title?((0,o.uX)(),(0,o.CE)("p",v,(0,n.v_)(a.payload[0]?.title),1)):(0,o.Q3)("",!0),a.payload[0]?.image?((0,o.uX)(),(0,o.CE)("img",{key:1,class:"w-full h-full",src:a.payload[0]?.image,alt:""},null,8,y)):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.payload[0]?.text,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,n.C4)(["flex",{"justify-between":M.wrapLine(e)>t.threshold}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,(a=>((0,o.uX)(),(0,o.CE)("p",{class:(0,n.C4)([{"mr-3":M.wrapLine(e)<=t.threshold},"helvetica text-[1.4163125rem] text-black"]),innerHTML:a},null,10,w)))),256))],2)))),256))]),(0,o.Lk)("div",$,[(0,o.Lk)("p",E,(0,n.v_)(a.payload[0]?a.payload[0].page:""),1)])]),(0,o.Lk)("div",L,[(0,o.Lk)("div",C,[(0,o.Lk)("p",R,(0,n.v_)(M.book.subtitle),1)]),(0,o.Lk)("div",_,[a.payload[1]?.title?((0,o.uX)(),(0,o.CE)("p",j,(0,n.v_)(a.payload[1]?.title),1)):(0,o.Q3)("",!0),a.payload[1]?.image?((0,o.uX)(),(0,o.CE)("img",{key:1,class:"w-full h-full",src:a.payload[1]?.image,alt:""},null,8,X)):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.payload[1]?.text,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,n.C4)(["flex",{"justify-between":M.wrapLine(e)>t.threshold}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,(a=>((0,o.uX)(),(0,o.CE)("p",{class:(0,n.C4)([{"mr-3":M.wrapLine(e)<=t.threshold},"helvetica text-[1.4163125rem] text-black"]),innerHTML:a},null,10,A)))),256))],2)))),256))]),(0,o.Lk)("div",I,[(0,o.Lk)("p",B,(0,n.v_)(a.payload[1]?a.payload[1].page:""),1)])])])),e[3]||(e[3]=(0,o.Lk)("img",{class:"absolute right-0 left-0 top-0 bottom-0 z-0",src:s,alt:"book.png"},null,-1))])}var T=a(6506),M=(a(9223),{name:"Preview",props:{payload:{type:Object},image:{type:File}},data:()=>({bookStore:(0,T._)(),threshold:25}),computed:{book(){return this.bookStore.book}},methods:{wrapLine(t){return t.reduce(((t,e)=>t+e.length),0)}}}),P=a(6262);const q=(0,P.A)(M,[["render",F],["__scopeId","data-v-1e300f8c"]]);var D=q},94:function(t,e,a){a.d(e,{A:function(){return u}});var o=a(641),n=a(33);const s={class:"flex justify-center items-center"},c={class:"w-[5.625rem] h-[2.0625rem] bg-[#D9D9D9] rounded flex justify-center items-center text-[1.125rem] mx-4"};function l(t,e,a,l,r,i){const p=(0,o.g2)("Icon");return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",{class:"hover:scale-110 cursor-pointer",onClick:e[0]||(e[0]=e=>t.$emit("prevPage"))},[(0,o.bF)(p,{type:"arrow_left"})]),(0,o.Lk)("div",c,(0,n.v_)(a.page)+" / "+(0,n.v_)(a.total_pages),1),(0,o.Lk)("div",{class:"hover:scale-110 cursor-pointer",onClick:e[1]||(e[1]=e=>t.$emit("nextPage"))},[(0,o.bF)(p,{type:"arrow_right"})])])}var r=a(1708),i={name:"Pagination",components:{Icon:r.A},props:{page:{type:Number,required:!0},total_pages:{type:Number,required:!0}}},p=a(6262);const h=(0,p.A)(i,[["render",l],["__scopeId","data-v-26ca3a2b"]]);var u=h},4002:function(t,e,a){a.d(e,{H2:function(){return s},Tg:function(){return l},W:function(){return c},xt:function(){return n}});var o=a(9223);function n(t){let e=35,a=18;t="    "+t;let n=t.split("\n"),s=[],c=[],l=[],r="",i=[];if(t.length>0){for(let a of n)if(a=a.replace("    ","¡¡¡¡"),a.length<=e||a.includes("<img"))s.push(a);else{let t=a.split(" ");for(let a of t)if([r,a].join(" ").length<=e)r=0===r.length?r+" "+a:[r,a].join(" ");else{a=(0,o.A)(a,{hyphens:!0}),l=a.split("­");let t=l.length;if([r,l[0]].join(" ").length<=e){r+=" "+l.shift();while(l.length>0&&[r,l[0]].join(" ").length<=e)r+=l.shift()}t!==l.length&&(r+="-"),s.push(r.trim()),r=l.join("")}s.push(r.trim()),r=""}let t=1;while(s.length>0)s[0].includes("<img")?(c.push(i),c.push([s.shift()]),i=[],t=1):t<=a?(i.push(s.shift()),t++):(c.push(i),i=[],t=1);c.push(i)}return c=c.map((t=>t.map((t=>t.replaceAll("¡¡¡¡","&nbsp;&nbsp;&nbsp;&nbsp;"))))),c=c.map((t=>t.map((t=>t.includes("<img")?[t]:t.split(" "))))),c}function s(t){let e=[];if(t){let a=t.split(" "),o="";for(let t=0;t<a.length;t++){let n=0===e.length?510:544;if(a[t].includes("<img")){e.push(o.trim()),o="";let n=[a[t],a[++t],a[++t]].join(" ");e.push(n)}else o.length+a[t].length<=n?o+=a[t]+" ":(e.push(o.trim()),o=a[t]+" ")}0!==o.length&&e.push(o.trim())}return e}function c(t,e,a){let o=[];for(let n in t)o.push({title:0==n?e:null,text:t[n],page:parseInt(a)+parseInt(n)+1});return o}function l(t){if(t.includes("<img"))return t;let e=t??"";e=e.replaceAll("\n","¡").replaceAll("  ","ºº"),e=(0,o.A)(e,{hyphens:!0}),e=e.split(" ");let a=[],n="";for(let o of e){let t=o.match(/((?!­).){1,32}/g);if(t){for(let e of t)n.length+e.length<=31?n+=e:(a.push(n+=(e!==t[0]?"-":"").replaceAll("¡","<br>").replaceAll("ºº","&nbsp;&nbsp;")),n=e);n+=" "}}return 0!==n.length&&a.push(n),a=a.join(""),a=a.replaceAll("¡","<br>").replaceAll("ºº","&nbsp;&nbsp;"),a}},6506:function(t,e,a){a.d(e,{_:function(){return n}});var o=a(5615);const n=(0,o.nY)("book",{state:()=>({book:null,chapter:null,chapters:[],covers:[]}),actions:{setBook(t){this.book=t},setChapter(t){this.chapter=t},setChapters(t){this.chapters=t},setCovers(t){this.covers=t},async fetchBookById(t){await this.$axios.get(`/book/${t}`).then((t=>{this.setBook(t.data.book)}))},async fetchBookByUserId(t){await this.$axios.get(`/book/user/${t}`).then((t=>{this.setBook(t.data.book)}))},async upsertQuestionnaire(t,e){await this.$axios.post(`/book/${t}/questionnaire`,e).then((t=>{alert("Ваша анкета успешно сохранена");let e=t.data.book;this.setBook(e),this.$router.push("/")}))},async getCovers(){await this.$axios.get("/book/covers").then((t=>{this.setCovers(t.data.covers)}))},async saveCover(t,e){await this.$axios.post(`/book/${t}/cover`,{cover_type_id:e}).then((t=>{this.setBook(t.data.book)}))},async getChapters(t){await this.$axios.get(`/book/${t}/chapters`).then((t=>{this.setChapters(t.data)}))},async saveTitle(t,e){await this.$axios.post(`/book/${t}/title`,e).then((t=>{alert(t.data.message),this.setBook(t.data.book)}))},async getChapter(t){return await this.$axios.get(`/chapter/${t}`).then((t=>(this.setChapter(t.data.chapter),t.data)))},async saveChapter(t,e){await this.$axios.post(`/chapter/${t}`,{text:e}).then((t=>{alert(t.data.message)}))},async generatePDF(t){await this.$axios.get(`/book/${t}/pdf`,{responseType:"blob"}).then((t=>{const e=URL.createObjectURL(t.data),a=document.createElement("a");a.href=e,a.setAttribute("download","file.pdf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(e)}))},async closeBook(t){return await this.$axios.post(`/book/${t}/close`).then((t=>t.data.message))},async toggleBook(t){await this.$axios.post(`/book/${t}/toggle`).then((t=>{alert(t.data.message)}))},async getTotalPages(t){return await this.$axios.get(`/book/${t}/total-pages`).then((t=>t.data.total_pages))},async addImage(t,e){let a=new FormData;return a.append("image",e),await this.$axios.post(`/chapter/${t}/image`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>t.data.url))}}})},9223:function(t,e,a){a.d(e,{A:function(){return m}});var o="[абвгдеёжзийклмнопрстуфхцчшщъыьэюя]",n="[аеёиоуыэюя]",s="[бвгджзклмнпрстфхцчшщ]",c="[йъь]",l="­",r="‑",i=" ",p="—",h="–",u="«",g="»",d={corto:"и|а|в|к|у|с|о|не|но|на|из|от|об|до|по|во|за|со",largo:"над|под|как"},f={hyphens:!1,digits:!1,digitsR:!1,header:!1,ndash:!1,quotes:!1},x={common:[[new RegExp("&nbsp;","gi"),i],[new RegExp(" (-|–|—) ","g"),"".concat(i).concat(p," ")],[new RegExp(" {2}","g")," "],[new RegExp("-(й|я|е) ","g"),"".concat(r,"$1 ")],[new RegExp("-(й|я|е) ","g"),"".concat(r,"$1").concat(i)],[new RegExp(" (".concat(d.corto,") "),"gi")," $1".concat(i)],[new RegExp("".concat(i,"(").concat(d.corto,") "),"gi"),"".concat(i,"$1").concat(i)],[new RegExp("^(".concat(d.corto,") "),"gi"),"$1".concat(i)]],digits:[[new RegExp(" (\\d+) ","g"),"".concat(i,"$1").concat(i)],[new RegExp("".concat(i,"(\\d+) "),"g"),"".concat(i,"$1").concat(i)]],digitsR:[[new RegExp(" (\\d+) ","g")," $1".concat(i)]],ndash:[[new RegExp("-","g"),"".concat(h)]],header:[[new RegExp(" (".concat(d.largo,") "),"gi")," $1".concat(i)]],hyphens:[[new RegExp("(".concat(c,")(").concat(o).concat(o,")"),"ig"),"$1".concat(l,"$2")],[new RegExp("(".concat(n,")(").concat(n).concat(o,")"),"ig"),"$1".concat(l,"$2")],[new RegExp("(".concat(n).concat(s,")(").concat(s).concat(n,")"),"ig"),"$1".concat(l,"$2")],[new RegExp("(".concat(s).concat(n,")(").concat(s).concat(n,")"),"ig"),"$1".concat(l,"$2")],[new RegExp("(".concat(n).concat(s,")(").concat(s).concat(s).concat(n,")"),"ig"),"$1".concat(l,"$2")],[new RegExp("(".concat(n).concat(s).concat(s,")(").concat(s).concat(s).concat(n,")"),"ig"),"$1".concat(l,"$2")]],quotes:[[new RegExp('\\="([^"]*)"',"gmi"),"='$1'"],[new RegExp('"('.concat(o,"|[0-9])"),"gmi"),"".concat(u,"$1")],[new RegExp('"',"gmi"),g],[new RegExp("\\='([^']*)'","gmi"),'="$1"']]};function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;if(null==t||"string"!==typeof t)return t;var a=Object.keys(x).reduce((function(t,a){return e[a]?t.concat(x[a]):t}),x.common);return a.reduce((function(t,e){return t.replace(e[0],e[1])}),t)}}}]);
//# sourceMappingURL=354.e489477c.js.map