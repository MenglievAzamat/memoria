"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[972],{9656:function(e,t,o){o.r(t),o.d(t,{default:function(){return P}});var s=o(641),a=o(33);const n={key:0},r={class:"flex justify-center items-center mb-8"};function i(e,t,o,i,l,g){const p=(0,s.g2)("Preview"),h=(0,s.g2)("Pagination");return e.pages.length>0?((0,s.uX)(),(0,s.CE)("div",n,[(0,s.bF)(p,{payload:e.pages[e.page-1]},null,8,["payload"]),(0,s.Lk)("div",r,[(0,s.bF)(h,{class:(0,a.C4)({"ml-[10.5625rem]":"admin"===e.userStore.user.type}),page:e.page,total_pages:e.pages.length,onNextPage:g.nextPage,onPrevPage:g.prevPage},null,8,["class","page","total_pages","onNextPage","onPrevPage"]),"admin"===e.userStore.user.type?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"ml-4",onClick:t[0]||(t[0]=(...e)=>g.generatePDF&&g.generatePDF(...e))},"PDF")):(0,s.Q3)("",!0),"client"===e.userStore.user.type?((0,s.uX)(),(0,s.CE)("button",{key:1,class:"ml-4",onClick:t[1]||(t[1]=(...e)=>g.closeBook&&g.closeBook(...e))},"Завершить книгу")):(0,s.Q3)("",!0)])])):(0,s.Q3)("",!0)}var l=o(8720),g=o(94),p=o(6506),h=o(3468),u=o(4002),c={name:"ReviewView",components:{Pagination:g.A,Preview:l.A},data:()=>({bookStore:(0,p._)(),userStore:(0,h.k)(),page:1,pages:[]}),methods:{getPages(){let e=this.bookStore.book,t=this.bookStore.chapters.chapters,o=[];this.pages[0]={title:e.title,subtitle:e.subtitle};for(let s of t){let e=(0,u.H)(s.text);o.push(...(0,u.W)(e,s.title,s.last_page??0))}while(o.length>0)this.pages.push(o.splice(0,2))},nextPage(){this.page<this.pages.length&&this.page++},prevPage(){this.page>1&&this.page--},generatePDF(){this.$router.push("/client/book/pdf")},async closeBook(){confirm("Вы действительно хотите завершить книгу? Вы не сможете редактировать свои внесённые изменения!")&&await this.bookStore.closeBook(this.bookStore.book.id).then((e=>{alert(e),location.href="/"}))}},mounted(){this.bookStore.getChapters(this.bookStore.book.id).then((()=>{this.getPages()}))}},k=o(6262);const b=(0,k.A)(c,[["render",i]]);var P=b}}]);
//# sourceMappingURL=972.32476e73.js.map