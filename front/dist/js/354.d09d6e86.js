"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[354],{9004:function(t,e,a){a.d(e,{A:function(){return P}});var o=a(641),s=a(33),l=a.p+"img/book.a7af3d3b.png";const r={class:"leotaro relative w-full h-[47.5rem] text-center flex justify-end items-center mb-[3.75rem]"},i={key:0,class:"w-1/2 pr-[3rem] pl-[1.5rem] z-10"},n={class:"text-black text-wrap text-[1.66625rem] font-['Leotaro']"},c={class:"text-[0.99975rem] font-['Leotaro']"},h={key:1,class:"w-full h-full px-[1.5rem] z-10 flex"},p={class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},d={class:"flex justify-between items-end"},u={class:"text-[0.99975rem] helvetica text-black"},k={class:"text-[0.99975rem] helvetica"},b={key:2,class:"w-full h-full px-[1.5rem] z-10 flex"},m={class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},f={class:"header h-[10%]"},x={class:"text-black text-wrap text-[1.66625rem] font-['Leotaro'] text-left"},v={class:"body h-[85%]"},y={key:0,class:"font-[Montserrat] text-black text-[1.66625rem] text-center mb-[.4rem] font-bold"},w=["src"],g=["innerHTML"],L={class:"footer h-[5%]"},C={class:"helvetica text-[1.4163125rem] text-black"},$={class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},E={class:"header h-[10%]"},X={class:"text-black text-wrap text-[1.66625rem] font-['Leotaro'] text-right"},_={class:"body h-[85%]"},T={key:0,class:"font-[Montserrat] text-black text-[1.66625rem] text-center mb-[.4rem] font-bold"},B=["src"],j=["innerHTML"],F={class:"footer h-[5%]"},I={class:"helvetica text-[1.4163125rem] text-black"};function S(t,e,a,S,U,M){return(0,o.uX)(),(0,o.CE)("div",r,[a.payload.title?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("h1",n,(0,s.v_)(a.payload.title),1),(0,o.Lk)("h2",c,(0,s.v_)(a.payload.subtitle),1)])):a.payload.review?((0,o.uX)(),(0,o.CE)("div",h,[e[2]||(e[2]=(0,o.Lk)("div",{class:"w-1/2 h-full flex flex-col justify-center p-[3.8rem]"},null,-1)),(0,o.Lk)("div",p,[e[1]||(e[1]=(0,o.Lk)("h1",{class:"text-black text-wrap text-[1.66625rem] font-['Leotaro'] mb-4"},"Содержание",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.payload.chapters,(t=>((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("h2",u,(0,s.v_)(t.title),1),e[0]||(e[0]=(0,o.Lk)("span",{class:"bb"},null,-1)),(0,o.Lk)("h2",k,(0,s.v_)((t.last_page??0)+1),1)])))),256))])])):((0,o.uX)(),(0,o.CE)("div",b,[(0,o.Lk)("div",m,[(0,o.Lk)("div",f,[(0,o.Lk)("p",x,(0,s.v_)(M.book.title),1)]),(0,o.Lk)("div",v,[a.payload[0]?.title?((0,o.uX)(),(0,o.CE)("p",y,(0,s.v_)(a.payload[0]?.title),1)):(0,o.Q3)("",!0),a.payload[0]?.image?((0,o.uX)(),(0,o.CE)("img",{key:1,class:"w-full h-full",src:a.payload[0]?.image,alt:""},null,8,w)):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.payload[0]?.text,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,s.C4)(["flex",{"justify-between":M.wrapLine(e)>t.threshold}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,(a=>((0,o.uX)(),(0,o.CE)("p",{class:(0,s.C4)([{"mr-3":M.wrapLine(e)<=t.threshold},"helvetica text-[1.4163125rem] text-black"]),innerHTML:a},null,10,g)))),256))],2)))),256))]),(0,o.Lk)("div",L,[(0,o.Lk)("p",C,(0,s.v_)(a.payload[0]?a.payload[0].page:""),1)])]),(0,o.Lk)("div",$,[(0,o.Lk)("div",E,[(0,o.Lk)("p",X,(0,s.v_)(M.book.subtitle),1)]),(0,o.Lk)("div",_,[a.payload[1]?.title?((0,o.uX)(),(0,o.CE)("p",T,(0,s.v_)(a.payload[1]?.title),1)):(0,o.Q3)("",!0),a.payload[1]?.image?((0,o.uX)(),(0,o.CE)("img",{key:1,class:"w-full h-full",src:a.payload[1]?.image,alt:""},null,8,B)):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.payload[1]?.text,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,s.C4)(["flex",{"justify-between":M.wrapLine(e)>t.threshold}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e,(a=>((0,o.uX)(),(0,o.CE)("p",{class:(0,s.C4)([{"mr-3":M.wrapLine(e)<=t.threshold},"helvetica text-[1.4163125rem] text-black"]),innerHTML:a},null,10,j)))),256))],2)))),256))]),(0,o.Lk)("div",F,[(0,o.Lk)("p",I,(0,s.v_)(a.payload[1]?a.payload[1].page:""),1)])])])),e[3]||(e[3]=(0,o.Lk)("img",{class:"absolute right-0 left-0 top-0 bottom-0 z-0",src:l,alt:"book.png"},null,-1))])}var U=a(6506),M={name:"Preview",props:{payload:{type:Object},image:{type:File}},data:()=>({bookStore:(0,U._)(),threshold:25}),computed:{book(){return this.bookStore.book}},methods:{wrapLine(t){return t.reduce(((t,e)=>t+e.length),0)}}},A=a(6262);const K=(0,A.A)(M,[["render",S],["__scopeId","data-v-ccb4971e"]]);var P=K},6388:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var o=a(641),s=a(3751);function l(t,e,a,l,r,i){const n=(0,o.g2)("Preview");return(0,o.uX)(),(0,o.CE)("div",null,[e[3]||(e[3]=(0,o.Lk)("p",{class:"text-[1.5rem] mb-[1.6875rem]"},"Введите текст титульного листа",-1)),(0,o.bo)((0,o.Lk)("textarea",{class:"mb-[0.6875rem]","onUpdate:modelValue":e[0]||(e[0]=e=>t.form.title=e),placeholder:"Заголовок..."},null,512),[[s.Jo,t.form.title]]),(0,o.bo)((0,o.Lk)("textarea",{class:"mb-[0.6875rem]","onUpdate:modelValue":e[1]||(e[1]=e=>t.form.subtitle=e),placeholder:"Подзаголовок..."},null,512),[[s.Jo,t.form.subtitle]]),(0,o.Lk)("button",{class:"mb-[1.125rem]",onClick:e[2]||(e[2]=(...t)=>i.saveTitle&&i.saveTitle(...t))},"Сохранить"),(0,o.bF)(n,{type:"cover",payload:t.form},null,8,["payload"])])}var r=a(9004),i=a(6506),n={name:"TitleView",components:{Preview:r.A},data:()=>({bookStore:(0,i._)(),form:{title:null,subtitle:null}}),methods:{saveTitle(){this.bookStore.saveTitle(this.bookStore.book.id,this.form)}},mounted(){this.bookStore.book&&(this.form={title:this.bookStore.book.title,subtitle:this.bookStore.book.subtitle})}},c=a(6262);const h=(0,c.A)(n,[["render",l]]);var p=h},6506:function(t,e,a){a.d(e,{_:function(){return s}});var o=a(5615);const s=(0,o.nY)("book",{state:()=>({book:null,chapter:null,chapters:[],covers:[]}),actions:{setBook(t){this.book=t},setChapter(t){this.chapter=t},setChapters(t){this.chapters=t},setCovers(t){this.covers=t},async fetchBookById(t){await this.$axios.get(`/book/${t}`).then((t=>{this.setBook(t.data.book)}))},async fetchBookByUserId(t){await this.$axios.get(`/book/user/${t}`).then((t=>{this.setBook(t.data.book)}))},async upsertQuestionnaire(t,e){await this.$axios.post(`/book/${t}/questionnaire`,e).then((t=>{alert("Ваша анкета успешно сохранена");let e=t.data.book;this.setBook(e),this.$router.push("/")}))},async getCovers(){await this.$axios.get("/book/covers").then((t=>{this.setCovers(t.data.covers)}))},async saveCover(t,e){await this.$axios.post(`/book/${t}/cover`,{cover_type_id:e}).then((t=>{this.setBook(t.data.book)}))},async getChapters(t){await this.$axios.get(`/book/${t}/chapters`).then((t=>{this.setChapters(t.data)}))},async saveTitle(t,e){await this.$axios.post(`/book/${t}/title`,e).then((t=>{alert(t.data.message),this.setBook(t.data.book)}))},async getChapter(t){return await this.$axios.get(`/chapter/${t}`).then((t=>(this.setChapter(t.data.chapter),t.data)))},async saveChapter(t,e){await this.$axios.post(`/chapter/${t}`,{text:e}).then((t=>{alert(t.data.message)}))},async deleteChapter(t){await this.$axios.delete(`/chapter/${t}`).then((t=>{alert(t.data.message)}))},async generatePDF(t){await this.$axios.get(`/book/${t}/pdf`,{responseType:"blob"}).then((t=>{const e=URL.createObjectURL(t.data),a=document.createElement("a");a.href=e,a.setAttribute("download","file.pdf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(e)}))},async closeBook(t){return await this.$axios.post(`/book/${t}/close`).then((t=>t.data.message))},async toggleBook(t){await this.$axios.post(`/book/${t}/toggle`).then((t=>{alert(t.data.message)}))},async getTotalPages(t){return await this.$axios.get(`/book/${t}/total-pages`).then((t=>t.data.total_pages))},async addImage(t,e){let a=new FormData;return a.append("image",e),await this.$axios.post(`/chapter/${t}/image`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>t.data.url))}}})}}]);
//# sourceMappingURL=354.d09d6e86.js.map