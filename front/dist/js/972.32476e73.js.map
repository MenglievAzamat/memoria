{"version":3,"file":"js/972.32476e73.js","mappings":"oLAAA,O,GAGaA,MAAM,yC,oFAFJC,EAAAA,MAAMC,OAAS,I,WAA1B,QAQM,MATV,IAEQ,QAAmC,GAAzBC,QAASF,EAAAA,MAAMG,EAAAA,KAAK,I,qBAC9B,QAKM,MALN,EAKM,EAJF,QACmF,GADtEJ,OAJzB,2BAI6E,UAAxBK,EAAAA,UAAUC,KAAKC,OAAqBH,KAAMA,EAAAA,KACtEI,YAAaP,EAAAA,MAAMC,OAAS,WAAU,EAAAO,SAAW,WAAU,EAAAC,U,iEACrB,UAAxBL,EAAAA,UAAUC,KAAKC,O,WAA1C,QAA6F,UANzG,MAMoBP,MAAM,OAA+C,QAAK,oBAAE,EAAAW,aAAA,EAAAA,eAAA,KAAa,SAN7F,eAOkF,WAAxBN,EAAAA,UAAUC,KAAKC,O,WAA7D,QAAwG,UAPpH,MAOoBP,MAAM,OAAQ,QAAK,oBAAE,EAAAY,WAAA,EAAAA,aAAA,KAAmD,qBAP5F,mC,qDAmBA,GACIC,KAAM,aAENC,WAAY,CAACC,WAAU,IAAEC,QAAO,KAEhCC,KAAM,KAAM,CACRC,WAAW,SACXb,WAAW,SAEXD,KAAM,EACNH,MAAO,KAGXkB,QAAS,CACL,QAAAC,GACI,IAAIC,EAAOC,KAAKJ,UAAUG,KACtBE,EAAWD,KAAKJ,UAAUK,SAASA,SACnCtB,EAAQ,GAEZqB,KAAKrB,MAAM,GAAK,CACZuB,MAAOH,EAAKG,MACZC,SAAUJ,EAAKI,UAGnB,IAAK,IAAIC,KAAWH,EAAU,CAC1B,IAAII,GAAe,OAAeD,EAAQE,MAE1C3B,EAAM4B,SAAQ,OAAcF,EAAcD,EAAQF,MAAOE,EAAQI,WAAa,GAClF,CAEA,MAAO7B,EAAMC,OAAS,EAClBoB,KAAKrB,MAAM4B,KAAK5B,EAAM8B,OAAO,EAAG,GAExC,EAEA,QAAAtB,GACQa,KAAKlB,KAAOkB,KAAKrB,MAAMC,QACvBoB,KAAKlB,MAEb,EAEA,QAAAM,GACQY,KAAKlB,KAAO,GACZkB,KAAKlB,MAEb,EAEA,WAAAO,GACIW,KAAKU,QAAQH,KAAK,mBACtB,EAEA,eAAMjB,GACEqB,QAAQ,yGACFX,KAAKJ,UAAUN,UAAUU,KAAKJ,UAAUG,KAAKa,IAAIC,MAAKC,IACxDC,MAAMD,GACNE,SAASC,KAAO,MAG5B,GAIJ,OAAAC,GACIlB,KAAKJ,UAAUuB,YAAYnB,KAAKJ,UAAUG,KAAKa,IAAIC,MAAK,KACpDb,KAAKF,UAAS,GAEtB,G,UChFJ,MAAMsB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://front/./src/views/Book/ReviewView.vue","webpack://front/./src/views/Book/ReviewView.vue?ca67"],"sourcesContent":["<template>\n    <div v-if=\"pages.length > 0\">\n        <Preview :payload=\"pages[page-1]\"/>\n        <div class=\"flex justify-center items-center mb-8\">\n            <Pagination :class=\"{'ml-[10.5625rem]' : userStore.user.type === 'admin' }\" :page=\"page\"\n                        :total_pages=\"pages.length\" @nextPage=\"nextPage\" @prevPage=\"prevPage\"/>\n            <button class=\"ml-4\" v-if=\"userStore.user.type === 'admin'\" @click=\"generatePDF\">PDF</button>\n            <button class=\"ml-4\" @click=\"closeBook\" v-if=\"userStore.user.type === 'client'\">Завершить книгу</button>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Preview from \"@/components/Book/Preview.vue\";\nimport Pagination from \"@/components/Pagination.vue\";\nimport {useBookStore} from \"@/stores/book\";\nimport {useUserStore} from \"@/stores/user\";\nimport {chapterDivider, pageFormatter} from \"@/plugins/helpers\";\n\nexport default {\n    name: \"ReviewView\",\n\n    components: {Pagination, Preview},\n\n    data: () => ({\n        bookStore: useBookStore(),\n        userStore: useUserStore(),\n\n        page: 1,\n        pages: [],\n    }),\n\n    methods: {\n        getPages() {\n            let book = this.bookStore.book\n            let chapters = this.bookStore.chapters.chapters\n            let pages = []\n\n            this.pages[0] = {\n                title: book.title,\n                subtitle: book.subtitle,\n            }\n\n            for (let chapter of chapters) {\n                let chapterPages = chapterDivider(chapter.text)\n\n                pages.push(...pageFormatter(chapterPages, chapter.title, chapter.last_page ?? 0))\n            }\n\n            while (pages.length > 0) {\n                this.pages.push(pages.splice(0, 2))\n            }\n        },\n\n        nextPage() {\n            if (this.page < this.pages.length) {\n                this.page++\n            }\n        },\n\n        prevPage() {\n            if (this.page > 1) {\n                this.page--\n            }\n        },\n\n        generatePDF() {\n            this.$router.push('/client/book/pdf')\n        },\n\n        async closeBook() {\n            if (confirm('Вы действительно хотите завершить книгу? Вы не сможете редактировать свои внесённые изменения!')) {\n                await this.bookStore.closeBook(this.bookStore.book.id).then(message => {\n                    alert(message)\n                    location.href = '/'\n                })\n            }\n        }\n    }\n    ,\n\n    mounted() {\n        this.bookStore.getChapters(this.bookStore.book.id).then(() => {\n            this.getPages()\n        })\n    }\n}\n</script>","import { render } from \"./ReviewView.vue?vue&type=template&id=5c653192\"\nimport script from \"./ReviewView.vue?vue&type=script&lang=js\"\nexport * from \"./ReviewView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","pages","length","payload","page","userStore","user","type","total_pages","nextPage","prevPage","generatePDF","closeBook","name","components","Pagination","Preview","data","bookStore","methods","getPages","book","this","chapters","title","subtitle","chapter","chapterPages","text","push","last_page","splice","$router","confirm","id","then","message","alert","location","href","mounted","getChapters","__exports__","render"],"sourceRoot":""}